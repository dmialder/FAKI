! когда соединяете таблицы, не забывайте о проблемы появления дублей, нужно проверять, что они не появились. Задача не будет засчитана, если при соединении таблицы дубликаты не будут убраны!
Под выручкой компании принимается сумма по столбцу: «salesRub», как в таблице singleSales так и в sales
Дата начало месяца – месяц и год представлены как даты на начало первого дня, т.е: 01-01-2020, 01-02-2020… 01-01-2021,01-02-2021….
Транзакция – одна запись в строке БД.
Транзакционная выручка – выручка за минусом себестоимости покупки товара.
Задачи на основании таблицы: singleSales
1.	Рассчитать выручку компании в разрезе: Год – Месяц – Выручка компании. Представленные данные отсортировать: Год, Месяц
2.	Рассчитать выручку компании в разрезе: Дата начало месяца – Выручка компании. Представление данных отсортировать: Дата начало месяца. В чем ключевое отличие от задачи №1? 
3.	Для каждой компании рассчитать среднее время между покупками, отдельно показать результат в днях и в месяцах.
4.	Вывести результат задачи №2 только для 2013 года с наложением на столбец «Дата начало месяц» формат месяц. Т. е. я ожидаю увидеть в нем не даты, а январь, февраль, март и т. д.
5.	Разделить все компании на три сегмента: 
a.	Очень давно не покупали – не было покупок более 365 дней от текущей даты
b.	Давно не покупали – не было покупок более 180 дней от текущей даты
c.	Не покупали – не было покупок более 90 дней от текущей даты
Текущею дату задать следующим образом: система должна брать существующею сегодня дату и смещать ее на 8 лет назад.
6.	Удалил
7.	Необходимо проверить существование сезонной выручки внутри недели, для этого необходимо рассчитать выручку компании в разрезе: Год – День Недели – выручка компании. Представленные данные отсортировать: Год, день недели.
8.	Найдите все компании, у которых в наименование есть «ООО», без учета регистра.
9.	Найдите все компании, у которых в наименование в начале стоит «ООО», без учета регистра и пробелов вначале.
10.	Необходимо разделить ФИ, что записаны в столбеце «fullName» на три столбца, выделив отдельно фамилию, имя и сокращённую форму: фамилия И. 
Задачи на основе таблиц: sales и справочников.
1.	Рассчитать выручку компании в разрезе: Год – Месяц – Филиал – Выручка компании. Представленные данные отсортировать: Филиал, Год, Месяц.
2.	Рассчитать выручку компании в разрезе: Филиал - Дата начало месяца – Выручка компании. Представление данных отсортировать: Филиал, Дата начало месяца.
3.	Рассчитать выручку компании в разрезе: Филиал – Дата начало месяца – Товарная категория – выручка компании. Представление данных отсортировать: Филиал, Дата начало месяца, Товарная категория.
4.	Рассчитать выручку компании в разрезе: Филиал – Дата начало месяца – Бренд – выручка компании. Представление данных отсортировать: Филиал, Дата начало месяца, Бренд. 
5.	Написать запрос, сравнивающий общую сумму задачи №4 и Задачи№2. Объяснить расхождения, если они есть. Написать запрос, выявляющий все транзакции влияющие на расхождения выручки в задаче №4.
6.	Определить топ 3 бренда, дающий наибольший вклад в выручку компании за 2013 год. 
7.	Рассчитать выручку компании в разрезе: Менеджер – Бренд – выручка компании. Представленные данные отсортировать: Менеджер, Бренд.
8.	 Рассчитать кол-во компаний приходятся на менеджера в течение каждого года. Фактически я ожидаю увидеть таблицу: Год – Менеджер – Кол-во компаний.
9.	Рассчитать транзакционную выручку компании по годам. Незабудке, что себестоимость в разных валютах и надо использовать курс валюты для пересчета. Если себестоимость представлена и в рублях, и в долларах, то у рублей приоритет.
10.	Рассчитать транзакционную выручку компании в разрезе: Филиал – Дата начало месяца – Бренд – транзакционная выручка компании. Представление данных отсортировать: Филиал, Дата начало месяца, Бренд. 
11.	В таблицу: distributor.remains представлена информация об остатках, как : Филиал – Артикул товара – Дата – Остаток – СвободныйОстаток. Особенность заполнения данной таблицы, что если остаток на какую-то дату нулевой (для товара и филиала), то в таблицу он не заноситься, например: 2020-01-01 – 10шт., 2020-01-02 – 7шт. 2020-01-04 – 15 шт. Необходимо, восстановить пропуски в данной таблицы и дописать пропущенные значения. Из нашего примера: 2020-01-03 – 0 шт. Учтите, что даты складирования товара – филиала своя.
12.	Найти объём неликвидного товара в сравнение со всем товаром в шт. под неликвидом считается товар, который не продавался более 180 дней от текущей даты. Точку отсчета текущей даты взять за 2014-01-01.
13.	Определить топ 3 лучших товаров по выручки для каждого Бренда без учета времени, т. е. за всю историю работы компании.
14.	Определить топ 3 лучших товаров по выручке для каждого бренда с учетом временного интервала год.
15.	Определить долю вклада Топ 3 брендов в выручку компании без учета времени, т. е. за всю историю работы компании.
16.	Определить долю вклада Топ 3 брендов в выручку компании для каждого года и месяца.
17.	Построить динамику изменения неликвидного товара по месяцам и по всем годам. Под неликвидом считается товар, который не продавался более 180 дней от текущей даты. Т. к. мы смотрим в динамике по месяцам, то для каждого месяца будет своя текущая дата, например, первый день месяца.
18.	Вывести топ 2 лучших менеджеров для каждого филиала в динамике. Под динамикой я хочу увидеть лучших менеджеров для каждого месяца – года. И отдельно только по годам.
19.	Вывести среднюю месячную динамику продаж, по выручке за предыдущие три месяца по менеджерам, для периода год – месяц и отдельно «Дата начало месяца». Т. е. если сейчас 2013-01-01, то я хочу видеть среднюю выручку по менеджерам за 2012-10-01, 2012-11-01,2012-12-01
20.	Вывести среднюю месячную динамику продаж, по среднему чеку за предыдущие три месяца по менеджерам, для периода год – месяц и отдельно «Дата начало месяца». Т. е. если сейчас 2013-01-01 то я хочу видеть средний чек по менеджерам за 2012-10-01, 2012-11-01,2012-12-01
21.	Вывести 5 лучших клиентов для каждого менеджера за последние три месяца в динамике. Под динамикой я хочу увидеть лучших клиентов по менеджерам для каждого месяца – года. И отдельно только по годам.
22.	У нас есть правило, если клиент:
a.	Купил товар первый раз и до этого ни разу не покупал, то ему присваиваться статус – Новый
b.	Покупает товар хотя бы раз в два месяца, то ему присваивается статус: Постоянный
c.	Если он не купил товар хотя бы раз за два месяца, то ему присваиваться статус: потенциально ушедший
d.	Если он не купил товар хотя бы раз за 4 месяца, то ему присваиваться статус: Ушедший
Необходимо собрать таблицу, в которой на каждый месяц, для каждой компании будет проставлен один из 4 статусов. Дату в таблице сделать как «Дата начало месяца».
23.	Рассчитать долю загрузки складов для каждого года – месяца.
24.	Рассчитайте стоимость складских запасов на основе себестоимости товара на каждом филиале для каждого разреза год – месяц (или дата начало месяца). Рассчитать так же и на основе альтернативной себестоимости, стоимость складских запасов. (basePrice из таблицы DDP)
25.	Рассчитать коэффициенты недельных сезонностей отдельно по штукам и деньгам для категории: Обои.
26.	Вывести долю занимающих в продажах, различных фабрик. Если в товаре фабрика не указана, сделать замену на «иные» и так же вывести в долях. Нужно вывести как за весь период, так и в разрезе Год – Месяц (или дата начало месяца)
27.	Рассчитать долю продаж эксклюзивного товара к общему, в разрезе каждого Год-Месяца (или дата начало месяца). Только для категории обои.
28.	Подтянуть к продажам обоев таблицу со спецификациями и провести различный анализ, найти какие нить закономерности и показать.
29.	
